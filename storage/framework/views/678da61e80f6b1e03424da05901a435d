<?php $__env->startSection('title',$title); ?>
<?php $__env->startSection('content'); ?>

<div class="row">
    <div class="col-md-12"><h4 class="page-head-line">New Application</h4></div>
</div>

<div class="wrap-content">
<div class="alert-danger">
      <?php foreach($errors->all() as $error): ?>
          <div class="error-list"><?php echo $error; ?></div>
      <?php endforeach; ?>
</div>
<div class="row">
<div class="col-md-12">
<div class="panel panel-default">
<div class="panel-heading"><h4>NEW FORM REQUEST (<?php echo e($request[0]->name); ?> - <?php echo e($form[0]->name); ?>)</h4></div>
<div class="panel-body">

<?php echo Form::open(['class'=>'submit_now', 'files'=>true]); ?>


<?php echo Form::hidden('type_request', $request[0]->name ); ?>

<?php echo Form::hidden('type_form', $form[0]->id ); ?>

<?php echo Form::hidden('department', $department[0]->department ); ?>

<div class="alert alert-info alert-dismissible fade in fixed-error">
        <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">Ã—</span></button>
        <strong> Message to Requestors : <?php echo e($form[0]->message); ?></strong>
  </div>
<div class="row form-details">
	<div class="col-md-6">
		<div class="clear-both box-scale">
			<h4>My Form Details</h4>
			<div class="info">
				<span class="labeler">Type of Request:</span>
				<span> <?php echo e($request[0]->name); ?> </span>
			</div>
			<div class="info">
				<span class="labeler">Form:</span>
				<span> <?php echo e($form[0]->name); ?> </span>
			</div>
			<div class="info">
				<span class="labeler">*Note: </span><span>We will notify your email address regarding the updates of forms</span>
			</div>
		</div>
	</div>

	<div class="col-md-6">
		<div class="clear-both box-scale">
			<h4>My Information</h4>
			<div class="info">
				<span class="labeler">Full Name:</span>
				<span> <?php echo e(Auth::user()->loginname); ?> </span>
			</div>
			<div class="info">
				<span class="labeler">Email:</span>
				<span> <?php echo e(Auth::user()->emailadd); ?> </span>
			</div>
			<div class="info">
				<span class="labeler">Department:</span>
				<span> <?php echo e($department[0]->department); ?> (<?php echo e($department[0]->deptdesc); ?>) </span>
			</div>
		</div>
	</div>
</div>

<!-- Select forms here conditional -->
<div class="row form-area-with-inputs">
	<div class="col-md-12">
	<h4>Please fillup the form below: require(*)</h4>

	<div class="row form-repeated">
		<div class="col-md-6">

      <?php if($form[0]->id == 1 || $form[0]->id == 15): ?>

        <div class="form-group">
      <!--          <label for="group">Flexi Group (*)</label>
          <?php echo Form::text('flexigroup',NULL,['class'=>'form-control flexigroup', 'id'=>'flexigroup']); ?>

            <br />
       -->
          <label for="approver">Approvers (*)</label>
          <?php echo Form::text('approver',NULL,['class'=>'form-control approver', 'id'=>'approver']); ?>

            <div class="approver-selected"></div>
            <br />
            <div class="approver-added">
                <h5 class="selecttitle">Verifier/Approvers: </h5>
            </div>
        </div>
       <?php elseif( $form[0]->id == 14): ?>
       <div class="form-group">
          <label for="approver">Please select one Verifier/approvers only (*)</label>
          <?php echo Form::text('approver',NULL,['class'=>'form-control approver', 'id'=>'approver_project_claims']); ?>

            <div class="approver-selected"></div>
            <br />
            <div class="approver-added">
                <div class="approver-added1">
                <h5 class="selecttitle">Verifier/Approvers: </h5>
      </div>
     <div class="approver-added2">
		           <?php foreach($approverlist as $keynote => $appr): ?>

		      			<?php if($keynote+1 == 1): ?>
		      				<?php /* */$word='Approver';/* */ ?>
		      			<?php elseif($keynote+1 == 2): ?>
		      				<?php /* */$word='2nd Verify';/* */ ?>
		      			<?php elseif($keynote+1 == 3): ?>
		      				<?php /* */$word='3rd Verify';/* */ ?>
		      			<?php else: ?>
		      				<?php /* */$word='th';/* */ ?>

                                        <?php endif; ?>
		      			<div id="approver_<?php echo e($keynote+2); ?>" class="hide"><i class="glyphicon glyphicon-minus-sign minus-approver-disabled"></i><span class="numbering_method"> <strong>[<?php echo e($word); ?>] </strong> <span></span></span> <?php echo e($appr->loginname); ?> <small><b><?php echo e($appr->emailadd); ?></b></small><input type="hidden" name="approver[]" id="approverfield_<?php echo e($keynote+2); ?>" value="<?php echo e($appr->idsrc_login); ?>"></div>
		      			<?php endforeach; ?>
                                          </div>
                </div>
        </div>
      <?php elseif( $form[0]->id == 12): ?>
       <div class="form-group">
          <label for="approver">Please select one Verifier/approvers only (*)</label>
          <?php echo Form::text('approver',NULL,['class'=>'form-control approver', 'id'=>'approver_cashadvance_acquittal']); ?>

            <div class="approver-selected"></div>
            <br />
            <div class="approver-added">
                <div class="approver-added1">
                <h5 class="selecttitle">Verifier/Approvers: </h5>
                 <?php foreach($approverlist as $keynote => $appr): ?>

		      		<?php if($keynote+1 == 1): ?>
		      				<?php /* */$word='1st Verify';/* */ ?>
                    <div id="approver_<?php echo e($keynote+1); ?>" class="hide">
                      <i class="glyphicon glyphicon-minus-sign minus-approver-disabled"></i>
                      <span class="numbering_method"> <strong>[<?php echo e($word); ?>] </strong> <span></span></span> <?php echo e($appr->loginname); ?>

                      <small><b><?php echo e($appr->emailadd); ?></b></small>
                      <input type="hidden" name="approver[]" id="approverfield_<?php echo e($keynote+1); ?>" value="<?php echo e($appr->idsrc_login); ?>">

                      <br />

                      <?php if(isset($appr['temp_approver_emailadd'])): ?>
                      <span class="numbering_method"> <strong>[Replacer]</strong> <span></span></span>
                      <?php else: ?>
                      <span class="numbering_method"><span></span></span>
                      <?php endif; ?>
                      <?php echo e($appr['temp_approver_loginname']); ?> <small><b><?php echo e($appr['temp_approver_emailadd']); ?></b></small>
                      <input type="hidden" name="temp_approver[]" value="<?php echo e($appr['temp_approver_id']); ?>">
                    </div>

		      				<?php endif; ?>
                                        <?php endforeach; ?>
      </div>

                   <div class="approver-added3">
		            <?php foreach($approverlist as $keynote => $appr): ?>

		      		<?php if($keynote+1 == 1): ?>

		      			<?php elseif($keynote+1 == 2): ?>
		      				<?php /* */$word='3rd Verify';/* */ ?>
                                                	<div id="approver_<?php echo e($keynote+2); ?>" class="hide" ><i class="glyphicon glyphicon-minus-sign minus-approver-disabled"></i><span class="numbering_method"> <strong>[<?php echo e($word); ?>] </strong> <span></span></span> <?php echo e($appr->loginname); ?> <small><b><?php echo e($appr->emailadd); ?></b></small><input type="hidden" name="approver[]" id="approverfield_<?php echo e($keynote+2); ?>" value="<?php echo e($appr->idsrc_login); ?>"></div>

		      			<?php elseif($keynote+1 == 3): ?>
                                                <?php /* */$word='Approver';/* */ ?>
                                                	<div id="approver_<?php echo e($keynote+2); ?>" class="hide" ><i class="glyphicon glyphicon-minus-sign minus-approver-disabled"></i><span class="numbering_method"> <strong>[<?php echo e($word); ?>] </strong> <span></span></span> <?php echo e($appr->loginname); ?> <small><b><?php echo e($appr->emailadd); ?></b></small><input type="hidden" name="approver[]" id="approverfield_<?php echo e($keynote+2); ?>" value="<?php echo e($appr->idsrc_login); ?>"></div>

		      			<?php endif; ?>
                                        <?php endforeach; ?>
                                          </div>
                </div>
        </div>
        <?php else: ?>

           <div class="form-group">
		   		<label for="approver">Verifier/Approver(s)</label>

		      <div class="approver-added">
		          <h5 class="selecttitle">Verifier/Approvers: </h5>
                            <?php /* */$len = count($approverlist);/* */ ?>

                          <?php if($form[0]->id == 13): ?>
                          <?php foreach($approverlist as $keynote => $appr): ?>

		      			<?php if($keynote+1 == 1): ?>
		      				<?php /* */$word='1st Verify';/* */ ?>
                                                	<div id="approver_<?php echo e($keynote+1); ?>" class="hide" ><i class="glyphicon glyphicon-minus-sign minus-approver-disabled"></i><span class="numbering_method"> <strong>[<?php echo e($word); ?>] </strong> <span></span></span> <?php echo e($appr->loginname); ?> <small><b><?php echo e($appr->emailadd); ?></b></small><input type="hidden" name="approver[]" id="approverfield_<?php echo e($keynote+1); ?>" value="<?php echo e($appr->idsrc_login); ?>"></div>

		      			<?php elseif($keynote+1 == 2): ?>
		      				<?php /* */$word='Approver';/* */ ?>
                                                	<div id="approver_<?php echo e($keynote+1); ?>" class="hide" ><i class="glyphicon glyphicon-minus-sign minus-approver-disabled"></i><span class="numbering_method"> <strong>[<?php echo e($word); ?>] </strong> <span></span></span> <?php echo e($appr->loginname); ?> <small><b><?php echo e($appr->emailadd); ?></b></small><input type="hidden" name="approver[]" id="approverfield_<?php echo e($keynote+1); ?>" value="<?php echo e($appr->idsrc_login); ?>"></div>
		      	              	<div id="approver_<?php echo e($keynote+2); ?>" class="hide" ><i class="glyphicon glyphicon-minus-sign minus-approver-disabled"></i><span class="numbering_method"> <strong>[2rd Verify] </strong> <span></span></span> <?php echo e($appr->loginname); ?> <small><b><?php echo e($appr->emailadd); ?></b></small><input type="hidden" name="approver[]" id="approverfield_<?php echo e($keynote+2); ?>" value="<?php echo e($appr->idsrc_login); ?>"></div>

		      			<?php elseif($keynote+1 == 3): ?>
                                                <?php /* */$word='Approver';/* */ ?>
                                  <div id="approver_<?php echo e($keynote+2); ?>" class="hide" ><i class="glyphicon glyphicon-minus-sign minus-approver-disabled"></i><span class="numbering_method"> <strong>[Approver] </strong> <span></span></span> <?php echo e($appr->loginname); ?> <small><b><?php echo e($appr->emailadd); ?></b></small><input type="hidden" name="approver[]" id="approverfield_<?php echo e($keynote+2); ?>" value="<?php echo e($appr->idsrc_login); ?>"></div>


		      			<?php endif; ?>
		      		<?php endforeach; ?>

                          <?php elseif($form[0]->id == 20): ?>
		           <?php foreach($approverlist as $keynote => $appr): ?>
		      			  <?php if($keynote == $len - 1): ?>
                                     	<?php /* */$word='Approver';/* */ ?>

                                   <?php else: ?>
		      			<?php if($keynote+1 == 1): ?>
		      				<?php /* */$word='1st Verify';/* */ ?>
		      			<?php elseif($keynote+1 == 2): ?>
		      				<?php /* */$word='2nd Verify';/* */ ?>
		      			<?php elseif($keynote+1 == 3): ?>
		      				<?php /* */$word='3rd Verify';/* */ ?>
		      			<?php else: ?>
		      				<?php /* */$word='th';/* */ ?>
		      			<?php endif; ?>
                                        <?php endif; ?>
		      			<div id="approver_<?php echo e($keynote+1); ?>" class="hide"><i class="glyphicon glyphicon-minus-sign minus-approver-disabled"></i><span class="numbering_method"> <strong>[<?php echo e($word); ?>] </strong> <span></span></span> <?php echo e($appr->loginname); ?> <small><b><?php echo e($appr->emailadd); ?></b></small><input type="hidden" name="approver[]" id="approverfield_<?php echo e($keynote+1); ?>" value="<?php echo e($appr->idsrc_login); ?>"></div>
		      		<?php endforeach; ?>
                            <?php elseif($form[0]->id == 19): ?>
                          <?php foreach($approverlist as $keynote => $appr): ?>
		      		<?php if($department[0]->idsrc_departments == 1 || $department[0]->idsrc_departments == 6 ): ?>
                                 <?php if($keynote+1 == 1): ?>
                                    <div id="approver_<?php echo e($keynote+1); ?>" ><i class="glyphicon glyphicon-minus-sign minus-approver-disabled"></i><span class="numbering_method"> <strong>[1st Verifier]</strong> <span></span></span> <?php echo e($appr->loginname); ?> <small><b><?php echo e($appr->emailadd); ?></b></small><input type="hidden" name="approver[]" id="approverfield_<?php echo e($keynote+1); ?>"   value="<?php echo e($appr->idsrc_login); ?>"></div>
		      		    <div id="approver_<?php echo e($keynote+2); ?>" ><i class="glyphicon glyphicon-minus-sign minus-approver-disabled"></i><span class="numbering_method"> <strong>[2rd Verifier]</strong> <span></span></span> <a target="_blank" href="<?php echo e(url('/flexigroup/viewflexigroup/2')); ?>">click to view</a><input type="hidden" name="approver[]" id="approverfield_<?php echo e($keynote+2); ?>"   value="group_2"></div>
                                        <?php elseif($keynote+1 == 2): ?>
                                    <div id="approver_<?php echo e($keynote+2); ?>" ><i class="glyphicon glyphicon-minus-sign minus-approver-disabled"></i><span class="numbering_method"> <strong>[Approver]</strong> <span></span></span> <?php echo e($appr->loginname); ?> <small><b><?php echo e($appr->emailadd); ?></b></small><input type="hidden" name="approver[]" id="approverfield_<?php echo e($keynote+2); ?>"   value="<?php echo e($appr->idsrc_login); ?>"></div>
                                 	<?php endif; ?>
                                <?php else: ?>
                                    <?php if($keynote+1 == 1): ?>
                                    <div id="approver_<?php echo e($keynote+1); ?>" ><i class="glyphicon glyphicon-minus-sign minus-approver-disabled"></i><span class="numbering_method"> <strong>[1st Verifier]</strong> <span></span></span> <?php echo e($appr->loginname); ?> <small><b><?php echo e($appr->emailadd); ?></b></small><input type="hidden" name="approver[]" id="approverfield_<?php echo e($keynote+1); ?>"   value="<?php echo e($appr->idsrc_login); ?>"></div>
		      		  <div id="approver_<?php echo e($keynote+2); ?>" ><i class="glyphicon glyphicon-minus-sign minus-approver-disabled"></i><span class="numbering_method"> <strong>[2rd Verifier]</strong> <span></span></span> <a target="_blank" href="<?php echo e(url('/flexigroup/viewflexigroup/2')); ?>">click to view</a><input type="hidden" name="approver[]" id="approverfield_<?php echo e($keynote+2); ?>"   value="group_2"></div>
                                         <?php elseif($keynote+1 == 2): ?>
                                     <div id="approver_<?php echo e($keynote+2); ?>" ><i class="glyphicon glyphicon-minus-sign minus-approver-disabled"></i><span class="numbering_method"> <strong>[3rd Verifier]</strong> <span></span></span> <?php echo e($appr->loginname); ?> <small><b><?php echo e($appr->emailadd); ?></b></small><input type="hidden" name="approver[]" id="approverfield_<?php echo e($keynote+2); ?>"   value="<?php echo e($appr->idsrc_login); ?>"></div>
                                      <?php else: ?>
                                     <div id="approver_<?php echo e($keynote+2); ?>" ><i class="glyphicon glyphicon-minus-sign minus-approver-disabled"></i><span class="numbering_method"> <strong>[Approver]</strong> <span></span></span> <?php echo e($appr->loginname); ?> <small><b><?php echo e($appr->emailadd); ?></b></small><input type="hidden" name="approver[]" id="approverfield_<?php echo e($keynote+2); ?>"   value="<?php echo e($appr->idsrc_login); ?>"></div>
		      			<?php endif; ?>

                                        <?php endif; ?>
                                        <?php endforeach; ?>
                          <?php else: ?>

		           <?php foreach($approverlist as $keynote => $appr): ?>

		      			  <?php if($keynote == $len - 1): ?>
                                     	<?php /* */$word='Approver';/* */ ?>

                                   <?php else: ?>

		      			<?php if($keynote+1 == 1): ?>
		      				<?php /* */$word='1st Verify';/* */ ?>
		      			<?php elseif($keynote+1 == 2): ?>
		      				<?php /* */$word='2rd Verify';/* */ ?>
		      			<?php elseif($keynote+1 == 3): ?>
		      				<?php /* */$word='3rd Verify';/* */ ?>
		      			<?php else: ?>
		      				<?php /* */$word='4rd Verify';/* */ ?>
		      			<?php endif; ?>
                                        <?php endif; ?>
                                        <?php if($appr['emailadd'] !='url'): ?>
		      			                           <div class="approver-list" id="approver_<?php echo e($keynote+1); ?>" >
                                             <i class="glyphicon glyphicon-minus-sign minus-approver-disabled"></i>
                                             <span class="numbering_method"> <strong></strong> <span></span></span>
                                             <?php echo e($appr['loginname']); ?> <small><b><?php echo e($appr['emailadd']); ?></b></small>
                                             <input type="hidden" name="approver[]" id="approverfield_<?php echo e($keynote+1); ?>" value="<?php echo e($appr['idsrc_login']); ?>"><br />
                                             <?php if(isset($appr['temp_approver_emailadd'])): ?>
                                             <span class="numbering_method"> <strong>[Replacer]</strong> <span></span></span>
                                             <?php else: ?>
                                             <span class="numbering_method"><span></span></span>
                                             <?php endif; ?>
                                             <?php echo e($appr['temp_approver_loginname']); ?> <small><b><?php echo e($appr['temp_approver_emailadd']); ?></b></small>
                                             <input type="hidden" name="temp_approver[]" value="<?php echo e($appr['temp_approver_id']); ?>">
                                           </div>
                                        <?php else: ?>
                                        <div class="approver-list" id="approver_<?php echo e($keynote+1); ?>" ><i class="glyphicon glyphicon-minus-sign minus-approver-disabled"></i><span class="numbering_method"> <strong></strong> <span></span></span> <?php echo e($appr['loginname']); ?> <a target="_blank" href="<?php echo e(url('/flexigroup/viewflexigroup/'.$appr['idsrc_login'])); ?>">click to view</a> <input type="hidden" name="approver[]" id="approverfield_<?php echo e($keynote+1); ?>"  value="group_<?php echo e($appr['idsrc_login']); ?>"></div>
                                        <?php endif; ?>
                                        <?php endforeach; ?>


                                <?php endif; ?>
		      </div>
		  	</div>
        <?php endif; ?>



  <?php if($form[0]->id == 1): ?>
		  	<div class="form-group">
				<label for="urgency">Urgency (*)</label>
				<div class="radio">
				<?php foreach($urgency as $urg): ?>
				 <label>
				      <?php echo Form::radio('urgency', $urg->urgency_id); ?>

				      <?php echo e($urg->urgency_name); ?>

				      <span> ( <?php echo e($urg->set_time); ?> hrs ) </span>
				    </label>
				<?php endforeach; ?>
				 </div>
				 <div id="urgency"></div>
			</div>
           <?php else: ?>
            <input type="hidden" name="urgency" value="1">
            <?php endif; ?>
		</div>
		<div class="col-md-6">
		<div class="form-group">
		    <label for="ccperson">Select CC Person(s)</label>
		    <?php echo Form::text('ccperson',NULL,['class'=>'form-control ccperson', 'id'=>'ccperson']); ?>

		    <div class="ccperson-selected"></div>
		    <br />
		    <div class="ccperson-added">
		      <h5 class="selecttitle">CC Persons : </h5>

                       <?php foreach($cclist as $keynote => $appr): ?>

		      			<?php if($keynote+1 == 1): ?>
		      				<?php /* */$word='st';/* */ ?>
		      			<?php elseif($keynote+1 == 2): ?>
		      				<?php /* */$word='nd';/* */ ?>
		      			<?php elseif($keynote+1 == 3): ?>
		      				<?php /* */$word='rd';/* */ ?>
		      			<?php else: ?>
		      				<?php /* */$word='th';/* */ ?>
		      			<?php endif; ?>
		      			<div><i class="glyphicon glyphicon-minus-sign minus-approver-disabled"></i><span class="numbering_method"> <span></span></span> <?php echo e($appr->loginname); ?> <small><b><?php echo e($appr->emailadd); ?></b></small><input type="hidden" name="ccperson[]" value="<?php echo e($appr->idsrc_login); ?>"></div>
		      		<?php endforeach; ?>

		    </div>
		</div>
		</div>
  	</div>
  	<hr />

		<?php if($form[0]->id == 2): ?>
		 	<?php echo $__env->make('forms.form_rcp', array_except(get_defined_vars(), array('__data', '__path')))->render(); ?>
		<?php elseif($form[0]->id == 3): ?>
		 	<?php echo $__env->make('forms.form_rca', array_except(get_defined_vars(), array('__data', '__path')))->render(); ?>
		<?php elseif($form[0]->id == 4): ?>
		 	<?php echo $__env->make('forms.form_area', array_except(get_defined_vars(), array('__data', '__path')))->render(); ?>
		<?php elseif($form[0]->id == 5): ?>
		 	<?php echo $__env->make('forms.form_arge', array_except(get_defined_vars(), array('__data', '__path')))->render(); ?>
		<?php elseif($form[0]->id == 6): ?>
		 	<?php echo $__env->make('forms.form_cdsaa', array_except(get_defined_vars(), array('__data', '__path')))->render(); ?>
		<?php elseif($form[0]->id == 7): ?>
		 	<?php echo $__env->make('forms.form_rdra', array_except(get_defined_vars(), array('__data', '__path')))->render(); ?>
		<?php elseif($form[0]->id == 8): ?>
		 	<?php echo $__env->make('forms.form_atac', array_except(get_defined_vars(), array('__data', '__path')))->render(); ?>
		<?php elseif($form[0]->id == 9): ?>
		 	<?php echo $__env->make('forms.form_hphcrf', array_except(get_defined_vars(), array('__data', '__path')))->render(); ?>
		<?php elseif($form[0]->id == 10): ?>
		 	<?php echo $__env->make('forms.form_mjr', array_except(get_defined_vars(), array('__data', '__path')))->render(); ?>
		<?php elseif($form[0]->id == 11): ?>
		 	<?php echo $__env->make('forms.form_pgvbf', array_except(get_defined_vars(), array('__data', '__path')))->render(); ?>
    <?php elseif($form[0]->id == 12): ?>
		 	<?php echo $__env->make('forms.form_sorapfca', array_except(get_defined_vars(), array('__data', '__path')))->render(); ?>
    <?php elseif($form[0]->id == 13): ?>
		 	<?php echo $__env->make('forms.form_aca', array_except(get_defined_vars(), array('__data', '__path')))->render(); ?>
    <?php elseif($form[0]->id == 14): ?>
			<?php echo $__env->make('forms.form_pcmcf', array_except(get_defined_vars(), array('__data', '__path')))->render(); ?>
    <?php elseif($form[0]->id == 20): ?>
		 	<?php echo $__env->make('forms.form_pcmcf2', array_except(get_defined_vars(), array('__data', '__path')))->render(); ?>
    <?php elseif($form[0]->id == 15): ?>
			<?php echo $__env->make('forms.form_mrf', array_except(get_defined_vars(), array('__data', '__path')))->render(); ?>
    <?php elseif($form[0]->id == 16): ?>
		 	<?php echo $__env->make('forms.form_tsw', array_except(get_defined_vars(), array('__data', '__path')))->render(); ?>
    <?php elseif($form[0]->id == 17): ?>
		 	<?php echo $__env->make('forms.form_irfi', array_except(get_defined_vars(), array('__data', '__path')))->render(); ?>
    <?php elseif($form[0]->id == 18): ?>
		 	<?php echo $__env->make('forms.form_coprpo', array_except(get_defined_vars(), array('__data', '__path')))->render(); ?>
    <?php elseif($form[0]->id == 19): ?>
		 	<?php echo $__env->make('forms.form_eoq', array_except(get_defined_vars(), array('__data', '__path')))->render(); ?>

		<?php else: ?>
			<?php echo $__env->make('forms.form_default', array_except(get_defined_vars(), array('__data', '__path')))->render(); ?>
		<?php endif; ?>


	<div class="margin-top-30"></div>
	<hr />
	</div>
</div>
<!-- end selected forms -->

<div class="form-group margin-top-30">
     <?php if($form[0]->id == 15): ?>
     <label for="urgency">Please attached JD of this position </label>
    <?php else: ?>
  <label for="urgency">Attachment(s) Upload (optional)</label>
  <?php endif; ?>
</div>
<div class="clear-left">
  <div class="wrap-zone">
  <div id="fileUpload" class="dropzone">
  <div class="dz-message" data-dz-message><span>Drop files here <br />or Click to Upload</span></div>
  </div>
  <div class="err-file"></div>
</div>

<div id="google-box">
  <button type="button" class="btn btn-default btn-lg" id="pick" >
  <i class="glyphicon glyphicon-paperclip"></i> Add Google Doc Links
  </button>
  <div class="google-list"></div>
  </div>
</div>
<div class="clear-left"><div class="file-list"></div></div>



<hr />
<?php if($form[0]->id == 13): ?>
<button type="submit" class="btn btn-default" id="submit" onclick="return ACAjevent();" >Submit</button>
<?php elseif($form[0]->id == 14 || $form[0]->id == 20): ?>
<button type="submit" class="btn btn-default" id="submit" onclick="return PCMCFjevent();" >Submit</button>
<?php elseif($form[0]->id == 19): ?>
<button type="submit" class="btn btn-default" id="submit" onclick="return EOQjevent();" >Submit</button>
<?php elseif($form[0]->id == 18): ?>
<button type="submit" class="btn btn-default" id="submit" onclick="return Coprpoevent();" >Submit</button>
<?php else: ?>
<button type="submit" class="btn btn-default" id="submit" >Submit</button>
<?php endif; ?>

<?php if($form[0]->id == 1): ?>
  <button type="submit" class="btn btn-default" style="display: none" id="save_drafts">Save Drafts</button>
<?php endif; ?>

<?php echo Form::close(); ?>

</div>
</div>
</div>
</div>

</div>

<script src="<?php echo e(URL::asset('js/dropzone.js')); ?>"></script>
<script type="text/javascript">
var approver_limit = 4;
var cc_limit = 20;

 $(function () {

	 $('.minus-approver').on('click', function(e,i){
	    $('span.numbering_method').remove();
	    $(this).parent().remove();
	    append_numbering();
	  });

	  $('.minus-ccperson').on('click', function(e,i){
	    $(this).parent().remove();
	  });

	$("input, textarea, select").change(function() {
		$('#save_drafts').fadeIn();
	});

  CKEDITOR.config.removePlugins = 'about,link';
  Dropzone.autoDiscover = false;

  var baseUrl = "<?php echo e(url('/')); ?>";
  var token = "<?php echo e(Session::getToken()); ?>";
  var AppFile = new Dropzone("div#fileUpload", {
            url: baseUrl+"/controller/uploadFiles",
            params: {
              _token: token
            }
      });

      Dropzone.options.AppFile = {
          paramName: "file", // The name that will be used to transfer the file
          addRemoveLinks: true,
      };

      AppFile.on("error", function(file, done) {
          console.log(file);
      });

      AppFile.on("addedfile", function(file, done) {
          var removeButton = Dropzone.createElement('<div class="remove-x"><button>Remove</button></div>');
          var _this = this;
          var name = file.name;

          if (this.files.length) {
              var _i, _len;
              for (_i = 0, _len = this.files.length; _i < _len - 1; _i++) // -1 to exclude current file
              {
                  if(this.files[_i].name === file.name && this.files[_i].size === file.size && this.files[_i].lastModifiedDate.toString() === file.lastModifiedDate.toString())
                  {
                      this.removeFile(file);
                  }
              }
          }
          removeButton.addEventListener("click", function(e) {
            e.preventDefault();
            e.stopPropagation();
            _this.removeFile(file);

              filrem =  $('.file-list input[data-file-name="'+name+'"]').val();
              filinput = $('.file-list input[data-file-name="'+name+'"]').parent().remove();

              $.ajax({
                  type: 'GET',
                  url: '/controller/removeFiles/'+filrem,
                  dataType: 'html',
                  success: function(data) {
                     console.log(data);
                  },
              });

          });
          file.previewElement.appendChild(removeButton);
      });

      AppFile.on("success", function(file, responseText) {
         var _ref;

           if(responseText.errors) {
              var errormsg = responseText.errors.file;

              this.removeFile(this.files);
              $('.err-file > span').remove();
              $('.err-file').append('<span class="alert alert-danger">'+errormsg+'<span>');
              setTimeout(function(){
                  $('.err-file > span').remove();
                }, 6000);

              return (_ref = file.previewElement) != null ? _ref.parentNode.removeChild(file.previewElement) : void 0;
           }

           if(responseText.status){
              $('.file-list').append('<div class="filesperline"><input data-file-name="'+responseText.file_name+'" type="hidden" name="fileurl[]" value="'+responseText.file_url+'" /> <input data-file-name="'+responseText.file_name+'" type="hidden" name="filename[]" value="'+responseText.file_name+'" /> <input data-file-name="'+responseText.file_name+'" type="hidden" name="mimetype[]" value="'+responseText.mimetype+'" /></div>');
           }
           else{

            this.removeFile(this.files);
            $('.err-file > span').remove();
            $('.err-file').append('<span class="alert alert-danger">Error. Size is too big to upload! Limit size: 3MB<span>');
            setTimeout(function(){
                $('.err-file > span').remove();
              }, 6000);
            return (_ref = file.previewElement) != null ? _ref.parentNode.removeChild(file.previewElement) : void 0;

           }
      });

$('.google-list').on('click','.remove-doc',function(e){
    e.preventDefault();
    $(this).parent().remove();
});

$('form').submit(function(event) {
  var sendAction = $(this).find("button[type=submit]:focus" ).attr('id');

  if(sendAction == 'submit'){
    event.preventDefault();

    for ( instance in CKEDITOR.instances ) {
        CKEDITOR.instances[instance].updateElement();
    }
    var form = $(this);
    var formdata = new FormData($("form")[0]);
    var progressTrigger;

    $.ajaxSetup({
        headers: {
            'X-CSRF-TOKEN': $('meta[name="csrf-token"]').attr('content')
        }
    });
    $.ajax({
        url     : '/controller/application/store',
        type    : form.attr("method"),
        data    : formdata,
        dataType: "json",
        processData: false,
        contentType: false,
        beforeSend:function(){
            $('.error-list').remove();
            $('.error-beside-submit').remove();
            $('.dz-hidden-input, form input, form textarea, form select, form radio, form button').prop('disabled', true);

            form.find('#submit').after('<span class="processing-time"><i class="fa fa-spinner fa-spin"></i> Submitting request. Please wait for awhile.</span>');
            form.find('#submit').css('display','none');

            progressTrigger = setTimeout(function(){
              $('.processing-time').remove();
              form.find('#submit').after('<span class="processing-time"><i class="fa fa-spinner fa-spin"></i> Sending notifications to selected Approver(s) and CC person(s)</span>');
            }, 4000);

        },

        error: function(xhr, textStatus, errorThrown) {

               for (var key in xhr.responseJSON.errors) {
                    if (key === 'length' || !xhr.responseJSON.errors.hasOwnProperty(key)) continue;
                    var value = xhr.responseJSON.errors[key];
                    $('#'+key).after('<div class="alert alert-danger error-list">'+value+'</div>')
                }

                form.find('.processing-time').remove();
                form.find('#submit').css({'display':'block'});
                form.find('#submit').after('<div class="alert-danger error-beside-submit">Error: Please check your form for an error.</div>')
                $('.dz-hidden-input, form input, form textarea, form select, form radio, form button').prop('disabled', false);

        },


        success : function ( data )
        {
            console.log(data);

            $('form').fadeOut().remove();
            $('.panel-body').append('<div class="form-group alert alert-success"> <b>Form</b> has successfully submitted!. To view the details of your submitted form. Please <a href="/application/view_details/'+data.form_id+'"><b>click here</b></a> </div>');

        },

        complete : function (){
            clearTimeout(progressTrigger);
        }
    })
  } else {

    $('form').attr('action', "/controller/history/save_drafts");

  }
  });
 });
</script>

<script src="<?php echo e(URL::asset('components/ckeditor/ckeditor.js')); ?>"></script>
<script src="<?php echo e(URL::asset('js/filepicker.js')); ?>"></script>
<script src="<?php echo e(URL::asset('js/general.config.js')); ?>"></script>
<script src="https://www.google.com/jsapi?key=AIzaSyCxQ1OXoUZBqgFtFsuTO2a4G1mlcGRCP1g"></script>
<script src="https://apis.google.com/js/client.js?onload=initPicker"></script>

<?php $__env->stopSection(); ?>

<?php echo $__env->make('layout.master', array_except(get_defined_vars(), array('__data', '__path')))->render(); ?>